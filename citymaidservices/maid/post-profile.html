<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create Your Profile - City Maid Services</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,typography,aspect-ratio"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        poppins: ['Poppins', 'sans-serif'],
                    },
                    colors: {
                        brand: {
                            primary: '#4F46E5',
                            secondary: '#4338CA',
                            light: '#EEF2FF',
                        }
                    }
                }
            }
        }
    </script>
</head>
<body class="font-poppins bg-gray-50" onload="initPage()">
    <!-- Navigation Bar -->
    <nav class="bg-white shadow-lg sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-20">
                <div class="flex items-center">
                    <a href="../index.html" class="text-3xl font-bold text-brand-primary tracking-tight">City<span class="text-brand-secondary"> Maid Services</span></a>
                </div>
                <!-- Desktop menu -->
                <div class="hidden md:flex items-center space-x-6">
                    <a href="../index.html" class="text-gray-700 hover:text-brand-primary font-medium transition-colors">Home</a>
                    <a href="../jobs/find-jobs.html" class="text-brand-primary font-semibold">Find Jobs</a>
                    <div class="relative group">
                        <button id="userMenuBtn" class="flex items-center space-x-2 text-gray-700 hover:text-brand-primary">
                            <i class="fas fa-user-circle text-2xl"></i>
                            <span class="font-medium">My Account</span>
                        </button>
                        <div class="hidden group-hover:block absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg">
                            <a href="dashboard.html" class="block px-4 py-2 hover:bg-gray-100">Dashboard</a>
                            <a href="post-profile.html" class="block px-4 py-2 hover:bg-gray-100">Profile</a>
                            <a href="#" id="signOutBtn" class="block px-4 py-2 hover:bg-gray-100">Sign Out</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Profile Creation Form -->
    <div class="max-w-4xl mx-auto px-4 py-8">
        <div class="bg-white rounded-lg shadow-lg p-6">
            <h1 class="text-2xl font-bold text-gray-900 mb-6">Create Your Profile</h1>
            
            <form id="profileForm" class="space-y-6">
                <!-- Profile Photo -->
                <div class="space-y-4">
                    <label class="block text-sm font-medium text-gray-700">Profile Photo *</label>
                    <div class="flex items-center space-x-4">
                        <div class="relative">
                            <div class="w-32 h-32 rounded-full bg-gray-200 flex items-center justify-center overflow-hidden">
                                <img id="profilePhotoPreview" src="https://via.placeholder.com/150?text=+" alt="Profile Photo" 
                                    class="w-32 h-32 object-cover">
                                <i id="placeholderIcon" class="fas fa-user-circle text-gray-400 text-5xl absolute"></i>
                            </div>
                            <input type="file" id="profilePhoto" accept="image/*" class="hidden" title="Upload profile photo" placeholder="Select a photo">
                            <button type="button" onclick="document.getElementById('profilePhoto').click()" 
                                class="absolute bottom-0 right-0 bg-brand-primary text-white p-3 rounded-full hover:bg-brand-secondary shadow-md" title="Upload photo">
                                <i class="fas fa-camera text-lg"></i>
                            </button>
                        </div>
                        <div class="space-y-2">
                            <p class="text-sm text-gray-700">Click the camera icon to upload your photo</p>
                            <p class="text-xs text-gray-500">Upload a clear face photo to increase your chances of getting hired</p>
                        </div>
                    </div>
                </div>

                <!-- Personal Information -->
                <div class="space-y-6">
                    <h2 class="text-lg font-semibold text-gray-900">Personal Information</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label for="fullName" class="block text-sm font-medium text-gray-700">Full Name *</label>
                            <input type="text" id="fullName" name="fullName" required
                                placeholder="Enter your full name as per documents"
                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                        </div>
                        <div>
                            <label for="ageGroup" class="block text-sm font-medium text-gray-700">Age Group *</label>
                            <select id="ageGroup" name="ageGroup" required
                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                                <option value="">Select Age Group</option>
                                <option value="18-25">18-25 years</option>
                                <option value="25-35">25-35 years</option>
                                <option value="35-45">35-45 years</option>
                                <option value="45+">45+ years</option>
                            </select>
                        </div>
                        <div>
                            <label for="gender" class="block text-sm font-medium text-gray-700">Gender *</label>
                            <select id="gender" name="gender" required
                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                                <option value="">Select Gender</option>
                                <option value="Female">Female</option>
                                <option value="Male">Male</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                        <div>
                            <label for="maritalStatus" class="block text-sm font-medium text-gray-700">Marital Status *</label>
                            <select id="maritalStatus" name="maritalStatus" required
                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                                <option value="">Select Status</option>
                                <option value="Single">Single</option>
                                <option value="Married">Married</option>
                                <option value="Divorced">Divorced</option>
                                <option value="Widowed">Widowed</option>
                            </select>
                        </div>
                        <div>
                            <label for="nationality" class="block text-sm font-medium text-gray-700">Nationality *</label>
                            <select id="nationality" name="nationality" required
                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                                <option value="">Select Nationality</option>
                                <option value="Nepali">Nepali</option>
                                <option value="Indian">Indian</option>
                                <option value="Bangladeshi">Bangladeshi</option>
                                <option value="Sri Lankan">Sri Lankan</option>
                                <option value="Filipino">Filipino</option>
                                <option value="Indonesian">Indonesian</option>
                                <option value="Bhutanese">Bhutanese</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                        <div>
                            <label for="religion" class="block text-sm font-medium text-gray-700">Religion</label>
                            <select id="religion" name="religion"
                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                                <option value="">Select Religion</option>
                                <option value="Hindu">Hindu</option>
                                <option value="Buddhist">Buddhist</option>
                                <option value="Muslim">Muslim</option>
                                <option value="Christian">Christian</option>
                                <option value="Kirat">Kirat</option>
                                <option value="Jain">Jain</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                        <div>
                            <label for="education" class="block text-sm font-medium text-gray-700">Education Level *</label>
                            <select id="education" name="education" required
                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                                <option value="">Select Education Level</option>
                                <option value="Under SEE">Under SEE</option>
                                <option value="SEE">SEE</option>
                                <option value="Intermediate">Intermediate</option>
                                <option value="Bachelor">Bachelor</option>
                                <option value="Master">Master</option>
                            </select>
                        </div>
                        <div>
                            <label for="documents" class="block text-sm font-medium text-gray-700">Available Documents *</label>
                            <select id="documents" name="documents" required
                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                                <option value="">Select Available Documents</option>
                                <option value="Citizenship">Citizenship Card Only</option>
                                <option value="Citizenship_Photo">Citizenship Card & Photo ID</option>
                                <option value="All">All Legal Documents</option>
                                <option value="Passport">Passport</option>
                                <option value="Work_Permit">Work Permit</option>
                                <option value="None">No Documents Available</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Contact Information -->
                <div class="space-y-6">
                    <h2 class="text-lg font-semibold text-gray-900">Contact Information</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label for="email" class="block text-sm font-medium text-gray-700">Email *</label>
                            <input type="email" id="email" name="email" required
                                placeholder="Enter your active email address"
                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                        </div>
                        <div>
                            <label for="phone" class="block text-sm font-medium text-gray-700">Phone Number *</label>
                            <input type="tel" id="phone" name="phone" required
                                placeholder="Enter your active phone number"
                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                        </div>
                        <div>
                            <label for="address" class="block text-sm font-medium text-gray-700">Current Residence Address *</label>
                            <input type="text" id="address" name="address" required
                                placeholder="Enter your current living address"
                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                        </div>
                        <div>
                            <label for="emergencyContact" class="block text-sm font-medium text-gray-700">Emergency Contact *</label>
                            <input type="tel" id="emergencyContact" name="emergencyContact" required
                                placeholder="Enter emergency contact number"
                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                        </div>
                    </div>
                </div>

                <!-- Specific Address Details -->
                <div class="mt-4">
                    <div class="flex items-center mb-2">
                        <input id="showAddressToggle" type="checkbox" class="rounded text-brand-primary focus:ring-brand-primary">
                        <label for="showAddressToggle" class="ml-2 text-sm font-medium text-gray-700">Add detailed residence location (optional, shared only with approved employers)</label>
                    </div>
                    <div id="addressFields" class="grid grid-cols-1 md:grid-cols-2 gap-6 hidden mt-4">
                        <div>
                            <label for="area" class="block text-sm font-medium text-gray-700">Area/Neighborhood</label>
                            <select id="area" name="area"
                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                                <option value="">Select Area</option>
                                <!-- Kathmandu Areas -->
                                <optgroup label="Kathmandu">
                                    <option value="Thamel">Thamel</option>
                                    <option value="Baluwatar">Baluwatar</option>
                                    <option value="Lazimpat">Lazimpat</option>
                                    <option value="Durbar Marg">Durbar Marg</option>
                                    <option value="Baneshwor">Baneshwor</option>
                                    <option value="Kalanki">Kalanki</option>
                                    <option value="Chabahil">Chabahil</option>
                                    <option value="Samakhusi">Samakhusi</option>
                                    <option value="Budhanilkantha">Budhanilkantha</option>
                                </optgroup>
                                <!-- Lalitpur Areas -->
                                <optgroup label="Lalitpur">
                                    <option value="Jhamsikhel">Jhamsikhel</option>
                                    <option value="Sanepa">Sanepa</option>
                                    <option value="Kupondole">Kupondole</option>
                                    <option value="Jawalakhel">Jawalakhel</option>
                                    <option value="Pulchowk">Pulchowk</option>
                                    <option value="Mangal Bazaar">Mangal Bazaar</option>
                                </optgroup>
                                <!-- Bhaktapur Areas -->
                                <optgroup label="Bhaktapur">
                                    <option value="Suryabinayak">Suryabinayak</option>
                                    <option value="Durbar Square">Durbar Square</option>
                                    <option value="Katunje">Katunje</option>
                                    <option value="Lokanthali">Lokanthali</option>
                                </optgroup>
                                <option value="Other">Other (Specify Below)</option>
                            </select>
                        </div>
                        <div>
                            <label for="landmark" class="block text-sm font-medium text-gray-700">Landmark</label>
                            <select id="landmark" name="landmark"
                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                                <option value="">Select Landmark Type</option>
                                <option value="Near School">Near School</option>
                                <option value="Near Hospital">Near Hospital</option>
                                <option value="Near Mall">Near Mall</option>
                                <option value="Near Temple">Near Temple</option>
                                <option value="Near Market">Near Market</option>
                                <option value="Near Hotel">Near Hotel</option>
                                <option value="Near Restaurant">Near Restaurant</option>
                                <option value="Near Bus Stop">Near Bus Stop</option>
                                <option value="Near Police Station">Near Police Station</option>
                                <option value="Other">Other (Specify Below)</option>
                            </select>
                        </div>
                        <div class="col-span-2">
                            <label for="addressNotes" class="block text-sm font-medium text-gray-700">Additional Address Notes</label>
                            <textarea id="addressNotes" name="addressNotes" rows="2"
                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary"
                                placeholder="Only if needed (e.g., building name, street name, specific directions)"></textarea>
                        </div>
                    </div>
                </div>

                <!-- Work Information -->
                <div class="space-y-6">
                    <h2 class="text-lg font-semibold text-gray-900">Work Information</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label for="experience" class="block text-sm font-medium text-gray-700">Years of Experience *</label>
                            <select id="experience" name="experience" required
                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                                <option value="0">No experience</option>
                                <option value="1">1+ year</option>
                                <option value="2">2+ years</option>
                                <option value="3">3+ years</option>
                                <option value="5">5+ years</option>
                                <option value="10">10+ years</option>
                            </select>
                        </div>
                        <div>
                            <label for="workType" class="block text-sm font-medium text-gray-700">Preferred Work Type *</label>
                            <select id="workType" name="workType" required
                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                                <option value="">Select Work Type</option>
                                <option value="Full-time">Full Time</option>
                                <option value="Part-time">Part Time</option>
                                <option value="Live-in">Live In</option>
                                <option value="Live-out">Live Out</option>
                                <option value="Daily">Daily Visit</option>
                            </select>
                        </div>
                        <div>
                            <label for="workingDays" class="block text-sm font-medium text-gray-700">Preferred Working Days</label>
                            <select id="workingDays" name="workingDays"
                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                                <option value="">Select Working Days</option>
                                <option value="Sun-Fri">Sunday to Friday</option>
                                <option value="Weekends">Weekends Only</option>
                                <option value="Flexible">Flexible Schedule</option>
                                <option value="Alternate">Alternate Days</option>
                                <option value="Daily">Daily</option>
                            </select>
                        </div>
                        <div>
                            <label for="preferredTime" class="block text-sm font-medium text-gray-700">Preferred Working Time *</label>
                            <select id="preferredTime" name="preferredTime" required
                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                                <option value="">Select Preferred Time</option>
                                <option value="Morning">Morning (6AM-12PM)</option>
                                <option value="Afternoon">Afternoon (12PM-6PM)</option>
                                <option value="Evening">Evening (6PM-10PM)</option>
                                <option value="Full Day">Full Day (8AM-5PM)</option>
                                <option value="6-2">6:00 AM - 2:00 PM</option>
                                <option value="7-3">7:00 AM - 3:00 PM</option>
                                <option value="8-4">8:00 AM - 4:00 PM</option>
                                <option value="9-5">9:00 AM - 5:00 PM</option>
                                <option value="10-6">10:00 AM - 6:00 PM</option>
                                <option value="2-10">2:00 PM - 10:00 PM</option>
                                <option value="Live-in">Live-in (Full Day)</option>
                                <option value="Flexible">Flexible Hours</option>
                            </select>
                        </div>
                        <div>
                            <label for="customHours" class="block text-sm font-medium text-gray-700">Custom Hours (if applicable)</label>
                            <select id="customHours" name="customHours"
                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                                <option value="">Select Hours</option>
                                <option value="1 hour daily">1 hour daily</option>
                                <option value="2 hours daily">2 hours daily</option>
                                <option value="3 hours daily">3 hours daily</option>
                                <option value="4 hours daily">4 hours daily</option>
                                <option value="5 hours daily">5 hours daily</option>
                                <option value="6 hours daily">6 hours daily</option>
                                <option value="8 hours daily">8 hours daily</option>
                                <option value="10 hours daily">10 hours daily</option>
                                <option value="2 hours, 3 days a week">2 hours, 3 days a week</option>
                                <option value="3 hours, 2 days a week">3 hours, 2 days a week</option>
                                <option value="4 hours weekly">4 hours weekly</option>
                                <option value="8 hours weekly">8 hours weekly</option>
                                <option value="One-time service">One-time service</option>
                            </select>
                        </div>
                        <div>
                            <label for="expectedSalary" class="block text-sm font-medium text-gray-700">Expected Monthly Salary (NPR) *</label>
                            <select id="expectedSalary" name="expectedSalary" required
                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                                <option value="">Select Expected Salary</option>
                                <option value="6000">NPR 6,000</option>
                                <option value="8000">NPR 8,000</option>
                                <option value="10000">NPR 10,000</option>
                                <option value="12000">NPR 12,000</option>
                                <option value="15000">NPR 15,000</option>
                                <option value="18000">NPR 18,000</option>
                                <option value="20000">NPR 20,000</option>
                                <option value="25000">NPR 25,000</option>
                                <option value="30000">NPR 30,000</option>
                            </select>
                        </div>
                        <div>
                            <label for="workLocation" class="block text-sm font-medium text-gray-700">Preferred Work Location *</label>
                            <select id="workLocation" name="workLocation" required
                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                                <option value="">Select where you're willing to work</option>
                                <option value="Kathmandu">Kathmandu</option>
                                <option value="Lalitpur">Lalitpur</option>
                                <option value="Bhaktapur">Bhaktapur</option>
                                <option value="Pokhara">Pokhara</option>
                                <option value="Biratnagar">Biratnagar</option>
                                <option value="Birgunj">Birgunj</option>
                                <option value="Any">Any Location</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Skills -->
                <div class="space-y-4">
                    <label class="block text-sm font-medium text-gray-700">Skills * (Select all that apply)</label>
                    <p class="text-xs text-gray-500 mb-2">Check all the services you can provide</p>
                    <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
                        <label class="flex items-center space-x-2">
                            <input type="checkbox" class="skill-checkbox" value="Cooking" name="skills">
                            <span>Cooking</span>
                        </label>
                        <label class="flex items-center space-x-2">
                            <input type="checkbox" class="skill-checkbox" value="Cleaning" name="skills">
                            <span>Cleaning</span>
                        </label>
                        <label class="flex items-center space-x-2">
                            <input type="checkbox" class="skill-checkbox" value="Laundry" name="skills">
                            <span>Laundry</span>
                        </label>
                        <label class="flex items-center space-x-2">
                            <input type="checkbox" class="skill-checkbox" value="Child Care" name="skills">
                            <span>Child Care</span>
                        </label>
                        <label class="flex items-center space-x-2">
                            <input type="checkbox" class="skill-checkbox" value="Elderly Care" name="skills">
                            <span>Elderly Care</span>
                        </label>
                        <label class="flex items-center space-x-2">
                            <input type="checkbox" class="skill-checkbox" value="Patient Care" name="skills">
                            <span>Patient Care</span>
                        </label>
                        <label class="flex items-center space-x-2">
                            <input type="checkbox" class="skill-checkbox" value="Pet Care" name="skills">
                            <span>Pet Care</span>
                        </label>
                        <label class="flex items-center space-x-2">
                            <input type="checkbox" class="skill-checkbox" value="Postnatal/Sutkeri Care" name="skills">
                            <span>Postnatal Care</span>
                        </label>
                        <label class="flex items-center space-x-2">
                            <input type="checkbox" class="skill-checkbox" value="Office Assistant" name="skills">
                            <span>Office Assistant</span>
                        </label>
                        <label class="flex items-center space-x-2">
                            <input type="checkbox" class="skill-checkbox" value="Gardening" name="skills">
                            <span>Gardening</span>
                        </label>
                        <label class="flex items-center space-x-2">
                            <input type="checkbox" class="skill-checkbox" value="Driving" name="skills">
                            <span>Driving</span>
                        </label>
                        <label class="flex items-center space-x-2">
                            <input type="checkbox" class="skill-checkbox" value="Ironing" name="skills">
                            <span>Ironing</span>
                        </label>
                        <label class="flex items-center space-x-2">
                            <input type="checkbox" class="skill-checkbox" value="Dishwashing" name="skills">
                            <span>Dishwashing</span>
                        </label>
                    </div>
                </div>

                <!-- Languages -->
                <div class="space-y-4">
                    <label for="languages" class="block text-sm font-medium text-gray-700">Languages *</label>
                    <select id="languages" name="languages" required
                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                        <option value="">Select Language</option>
                        <option value="Nepali">Nepali</option>
                        <option value="English">English</option>
                        <option value="Hindi">Hindi</option>
                        <option value="Newari">Newari</option>
                        <option value="Tamang">Tamang</option>
                        <option value="Gurung">Gurung</option>
                        <option value="Magar">Magar</option>
                        <option value="Tharu">Tharu</option>
                    </select>
                </div>

                <!-- About Me -->
                <div class="space-y-4">
                    <label for="descriptionTemplate" class="block text-sm font-medium text-gray-700">About Me Template</label>
                    <select id="descriptionTemplate" name="descriptionTemplate"
                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary">
                        <option value="">Select a Profile Template</option>
                        <option value="general-helper">General Domestic Helper</option>
                        <option value="childcare">Childcare Specialist</option>
                        <option value="cooking">Cooking Specialist</option>
                        <option value="elderly-care">Elderly Care Specialist</option>
                        <option value="patient-care">Patient Care Specialist</option>
                        <option value="live-in">Live-in Maid</option>
                        <option value="custom">Custom Description</option>
                    </select>
                    
                    <label for="about" class="block text-sm font-medium text-gray-700">About Me *</label>
                    <textarea id="about" name="about" rows="4" required
                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-primary focus:ring-brand-primary"
                        placeholder="Tell employers about yourself, your experience, and what makes you a great domestic helper"></textarea>
                </div>

                <!-- Submit Button -->
                <div class="flex justify-end">
                    <button type="submit"
                        class="bg-brand-primary text-white px-8 py-3 rounded-lg hover:bg-brand-secondary transition-colors">
                        Create Profile
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Initialize Supabase client
        const supabaseUrl = 'https://fdgqqxyyofjnkhswkwcq.supabase.co';
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZkZ3FxeHl5b2Zqbmtoc3drd2NxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDQwMjQyMTMsImV4cCI6MjA1OTYwMDIxM30.YyJLLu3r2a7Mh7ny0ie-YzzLfPh5PdrJJHnBFBxWqVE';
        const supabaseClient = supabase.createClient(supabaseUrl, supabaseKey);
        
        // Session related variables
        let currentUser = null;
        
        // Main initialization function
        function initPage() {
            console.log("Initializing page...");
            
            // Set up photo preview
            setupPhotoPreview();
            
            // Set up description templates
            setupDescriptionTemplates();
            
            // Set up address toggle
            setupAddressToggle();
            
            // Authentication check
            checkSession();
        }
        
        // Setup photo preview functionality
        function setupPhotoPreview() {
            console.log("Setting up photo preview...");
            const profilePhotoInput = document.getElementById('profilePhoto');
            const profilePhotoPreview = document.getElementById('profilePhotoPreview');
            const placeholderIcon = document.getElementById('placeholderIcon');
            
            // Initially show placeholder icon and hide the preview image
            profilePhotoPreview.style.opacity = '0';
            placeholderIcon.style.display = 'block';
            
            if (profilePhotoInput && profilePhotoPreview) {
                profilePhotoInput.addEventListener('change', function() {
                    const file = this.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            profilePhotoPreview.src = e.target.result;
                            // Show the image and hide the placeholder
                            profilePhotoPreview.style.opacity = '1';
                            placeholderIcon.style.display = 'none';
                        };
                        reader.readAsDataURL(file);
                    }
                });
            }
        }
        
        // Setup description templates functionality
        function setupDescriptionTemplates() {
            console.log("Setting up description templates...");
            const descriptionTemplateSelect = document.getElementById('descriptionTemplate');
            const descriptionTextarea = document.getElementById('about');
            
            if (descriptionTemplateSelect && descriptionTextarea) {
                descriptionTemplateSelect.addEventListener('change', function() {
                    console.log("Template selected:", this.value);
                    const selectedTemplate = this.value;
                    let templateText = '';
                    
                    switch(selectedTemplate) {
                        case 'general-helper':
                            templateText = "I am a reliable and hardworking domestic helper with experience in cleaning, cooking, and household management. I am detail-oriented, organized, and committed to maintaining a clean and comfortable home environment. I pride myself on being trustworthy, respectful, and efficient in my work.";
                            break;
                        case 'childcare':
                            templateText = "I am a caring and patient childcare specialist with experience looking after children of various ages. I can assist with meal preparation, bathing, educational activities, and creating a safe environment for children. I am energetic, attentive, and enjoy engaging children in creative and educational play.";
                            break;
                        case 'cooking':
                            templateText = "I am a skilled cook specializing in Nepali and international cuisine. I can prepare nutritious and delicious meals for families of all sizes. I am knowledgeable about various cooking techniques, food safety, and dietary requirements. I enjoy creating meal plans and can accommodate special dietary needs.";
                            break;
                        case 'elderly-care':
                            templateText = "I am a compassionate caregiver with experience in elderly care. I can assist with personal care, medication reminders, meal preparation, and companionship. I am patient, attentive to needs, and respectful of dignity. I strive to create a comfortable and positive environment for elderly individuals.";
                            break;
                        case 'patient-care':
                            templateText = "I am a dedicated patient care specialist with experience in assisting those with medical needs. I can help with personal care, medication management, monitoring health conditions, and providing emotional support. I am trained in basic medical assistance and dedicated to ensuring the comfort and wellbeing of patients.";
                            break;
                        case 'live-in':
                            templateText = "I am a responsible live-in domestic helper experienced in managing all household duties. I can handle cleaning, cooking, laundry, and other household tasks. I am adaptable, discreet, and respectful of family privacy. I aim to become a valuable part of your household while maintaining professional boundaries.";
                            break;
                        case 'custom':
                            templateText = ""; // Empty for custom description
                            break;
                    }
                    
                    if (templateText) {
                        descriptionTextarea.value = templateText;
                    }
                });
            }
        }
        
        // Setup address toggle functionality
        function setupAddressToggle() {
            console.log("Setting up address toggle...");
            const showAddressToggle = document.getElementById('showAddressToggle');
            const addressFields = document.getElementById('addressFields');
            
            if (showAddressToggle && addressFields) {
                showAddressToggle.addEventListener('change', function() {
                    if (this.checked) {
                        addressFields.classList.remove('hidden');
                    } else {
                        addressFields.classList.add('hidden');
                    }
                });
            }
        }
        
        // Check session and redirect if not logged in
        async function checkSession() {
            try {
                const { data: { session }, error: sessionError } = await supabaseClient.auth.getSession();
                if (sessionError) throw sessionError;
                
                if (!session) {
                    window.location.href = '../auth/login.html?type=maid';
                    return;
                }

                // Check if user is a maid
                const { data: profile, error: profileError } = await supabaseClient
                    .from('profiles')
                    .select('user_type')
                    .eq('id', session.user.id)
                    .single();
                    
                if (profileError) {
                    console.error('Error fetching profile:', profileError);
                    return;
                }
                
                if (profile.user_type !== 'maid') {
                    window.location.href = '../employer/post-job.html';
                    showError('This page is only for domestic helpers');
                    return;
                }
                
                // Store current user
                currentUser = session.user;
                
                // Prefill email if available
                if (currentUser.email) {
                    document.getElementById('email').value = currentUser.email;
                }
                
                // Check if profile already exists
                const { data: existingProfile, error: checkError } = await supabaseClient
                    .from('maid_profiles')
                    .select('id')
                    .eq('user_id', currentUser.id)
                    .single();
                    
                if (!checkError && existingProfile) {
                    // Profile exists, redirect to profile edit page
                    window.location.href = 'profile.html';
                    return;
                }
            } catch (error) {
                console.error('Error checking session:', error);
                showError('Error authenticating user. Please try again.');
            }
        }
        
        // Handle profile photo upload
        async function uploadProfilePhoto(userId, file) {
            try {
                if (!file) return null;
                
                const fileExt = file.name.split('.').pop();
                const fileName = `${userId}-${Date.now()}.${fileExt}`;
                const filePath = `${fileName}`;
                
                const { error: uploadError } = await supabaseClient.storage
                    .from('profile-photos')
                    .upload(filePath, file);
                    
                if (uploadError) throw uploadError;
                
                return filePath;
            } catch (error) {
                console.error('Error uploading photo:', error);
                throw new Error('Failed to upload profile photo');
            }
        }
        
        // Handle form submission
        document.getElementById('profileForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            try {
                // Show loading state
                const submitButton = document.querySelector('button[type="submit"]');
                submitButton.disabled = true;
                submitButton.textContent = 'Creating...';
                
                // Get current session
                const { data: { session }, error: sessionError } = await supabaseClient.auth.getSession();
                if (sessionError || !session) {
                    throw new Error('Please log in again');
                }
                
                // Upload photo if provided
                const photoFile = document.getElementById('profilePhoto').files[0];
                let photoPath = null;
                
                if (photoFile) {
                    photoPath = await uploadProfilePhoto(session.user.id, photoFile);
                }
                
                // Collect form data
                const formData = new FormData(e.target);
                const skills = Array.from(document.querySelectorAll('.skill-checkbox:checked'))
                    .map(checkbox => checkbox.value);
                
                // Get language value from the dropdown
                const language = document.getElementById('languages').value;
                
                // Get specific address information
                const showAddress = document.getElementById('showAddressToggle').checked;
                let addressInfo = null;
                
                if (showAddress) {
                    addressInfo = {
                        area: document.getElementById('area').value,
                        landmark: document.getElementById('landmark').value,
                        notes: document.getElementById('addressNotes').value
                    };
                }
                
                // Prepare profile data
                const profileData = {
                    user_id: session.user.id,
                    profile_photo: photoPath,
                    full_name: formData.get('fullName'),
                    age_group: formData.get('ageGroup'),
                    gender: formData.get('gender'),
                    marital_status: formData.get('maritalStatus'),
                    nationality: formData.get('nationality'),
                    religion: formData.get('religion'),
                    education: formData.get('education'),
                    documents: formData.get('documents'),
                    email: formData.get('email'),
                    phone: formData.get('phone'),
                    address: formData.get('address'),
                    specific_address: showAddress ? addressInfo : null,
                    emergency_contact: formData.get('emergencyContact'),
                    years_of_experience: parseInt(formData.get('experience')),
                    work_type: formData.get('workType'),
                    working_days: formData.get('workingDays'),
                    preferred_time: formData.get('preferredTime'),
                    custom_hours: formData.get('customHours'),
                    expected_salary: parseInt(formData.get('expectedSalary')),
                    work_location: formData.get('workLocation'),
                    skills: skills,
                    language: language,
                    additional_notes: formData.get('about'),
                    created_at: new Date().toISOString(),
                    updated_at: new Date().toISOString()
                };
                
                // Save to Supabase
                const { data, error } = await supabaseClient
                    .from('maid_profiles')
                    .insert([profileData]);
                    
                if (error) throw error;
                
                // Show success message
                showSuccess('Your profile has been created successfully!');
                
                // Reset button state
                submitButton.disabled = false;
                submitButton.textContent = 'Create Profile';
                
                // Redirect to dashboard after delay
                setTimeout(() => {
                    window.location.href = 'dashboard.html';
                }, 2000);
            } catch (error) {
                console.error('Error creating profile:', error);
                
                // Reset button state
                const submitButton = document.querySelector('button[type="submit"]');
                submitButton.disabled = false;
                submitButton.textContent = 'Create Profile';
                
                showError(error.message || 'Failed to create profile. Please try again.');
            }
        });
        
        // Handle sign out
        document.getElementById('signOutBtn').addEventListener('click', async function() {
            try {
                const { error } = await supabaseClient.auth.signOut();
                if (error) throw error;
                window.location.href = '../index.html';
            } catch (error) {
                console.error('Error signing out:', error);
                showError('Error signing out. Please try again.');
            }
        });
        
        // Show success message
        function showSuccess(message) {
            const toast = document.createElement('div');
            toast.className = 'fixed bottom-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 flex items-center';
            toast.innerHTML = `
                <i class="fas fa-check-circle mr-2"></i>
                <span>${message}</span>
            `;
            document.body.appendChild(toast);
            
            // Remove after 3 seconds
            setTimeout(() => {
                toast.remove();
            }, 3000);
        }
        
        // Show error message
        function showError(message) {
            const toast = document.createElement('div');
            toast.className = 'fixed bottom-4 right-4 bg-red-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 flex items-center';
            toast.innerHTML = `
                <i class="fas fa-exclamation-circle mr-2"></i>
                <span>${message}</span>
            `;
            document.body.appendChild(toast);
            
            // Remove after 3 seconds
            setTimeout(() => {
                toast.remove();
            }, 3000);
        }
    </script>
</body>
</html> 